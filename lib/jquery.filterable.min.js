/**
 * filterable
 * jQuery plugin that filters an HTML table based on column-specific values using x-editable
 *
 * @author Daniel White
 * @copyright Daniel White 2013
 * @license MIT <https://github.com/lightswitch05/filterable/blob/master/MIT-LICENSE>
 * @link https://github.com/lightswitch05/filterable
 * @module filterable
 * @version 0.0.1
 */
(function(e){e.fn.filterable=function(t){var n={ignoreColumns:[],onlyColumns:null,prependWild:!0,appendWild:!0,ignoreCase:!0};t=e.extend(n,t);var r=function(e){return e!==undefined&&e!==null?!0:!1},i=function(t){e(t).addClass("filterable-match"),e(t).removeClass("filterable-no-match")},s=function(t){e(t).addClass("filterable-no-match"),e(t).removeClass("filterable-match")},o=function(e,n){e=e.replace(/\*/,".*"),e=t.prependWild?".*"+e:e,e+=t.appendWild?".*":e;var r=t.ignoreCase?"i":"",i=new RegExp(e,r);return i.test(n)===!0},u=function(t){return e(t).find("td.filterable-no-match").length===0},a=function(t){e(t).addClass("filterable-active")},f=function(t){e(t).removeClass("filterable-active")},l=function(t,n){var r=n.closest("table"),l=n.data("name");t===""?f(n):a(n),r.children("tbody,*").children("tr").each(function(n,r){if(n!==0){var a=e(r).children("td").eq(l),f=e.trim(a.text());o(t,f)?(i(a),u(r)&&i(r)):(s(a),s(r))}})},c=function(t){e(t).editable({send:"never",type:"text",emptytext:"",display:function(){e(this).text("")}})},h=function(e){e.on("save",function(t,n){l(n.newValue,e)})},p=function(t,n){var r="Enter filter for "+e.trim(t.text()),i=' <i class="icon-filter filterable" data-name="'+n+'" title="'+r+'"></i>';return i=t.append(i).find("i.icon-filter"),c(i),i},d=function(n){return r(t.onlyColumns)?e.inArray(n,t.onlyColumns)===-1:e.inArray(n,t.ignoreColumns)!==-1},v=function(t){var n=t.find("tr:first").first(),r={};return e(n).children("td,th").each(function(t,n){d(t)||(r[t]=e(n))}),r},m=v(this);e.each(m,function(e,t){var n=p(t,e);h(n)})}})(jQuery);